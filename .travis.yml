language: python

services:
  - docker

env:
  - DOCKER_IMAGE=pangeo/pangeo-ocean:2019.03.12
  - DOCKER_IMAGE=pangeo/pangeo-notebook

before_install:
- docker pull $DOCKER_IMAGE
- docker run -d --name pangeo $DOCKER_IMAGE
- docker exec pangeo bash -c "pip install pytest"
- docker ps -a

install:
- docker cp . pangeo:/home/jovyan/

script:
- >
   docker exec pangeo env TERM=xterm script bash -c
   "py.test --durations=9999 -v tests/validate_datasets.py;
   EXIT_CODE=$?;
   echo EXIT_CODE=$EXIT_CODE;
   exit $EXIT_CODE"
